document.addEventListener("DOMContentLoaded",(()=>{if(!CONFIG.path){console.warn("`hexo-generator-searchdb` plugin is not installed!");return}const e=new LocalSearch({path:CONFIG.path,top_n_per_article:CONFIG.localsearch.top_n_per_article,unescape:CONFIG.localsearch.unescape});const t=document.querySelector(".search-input");const s=()=>{if(!e.isfetched)return;const s=t.value.trim().toLowerCase();const c=s.split(/[-\s]+/);const r=document.querySelector(".search-result-container");let n=[];if(s.length>0){n=e.getResultItems(c)}if(c.length===1&&c[0]===""){r.classList.add("no-result");r.innerHTML='<div class="search-result-icon"><i class="fa fa-search fa-5x"></i></div>'}else if(n.length===0){r.classList.add("no-result");r.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>'}else{n.sort(((e,t)=>{if(e.includedCount!==t.includedCount){return t.includedCount-e.includedCount}else if(e.hitCount!==t.hitCount){return t.hitCount-e.hitCount}return t.id-e.id}));const e=CONFIG.i18n.hits.replace("${hits}",n.length);r.classList.remove("no-result");r.innerHTML=`<div class="search-stats">${e}</div>\n        <hr>\n        <ul class="search-result-list">${n.map((e=>e.item)).join("")}</ul>`;if(typeof pjax==="object")pjax.refresh(r)}};e.highlightSearchWords(document.querySelector(".post-body"));if(CONFIG.localsearch.preload){e.fetchData()}if(CONFIG.localsearch.trigger==="auto"){t.addEventListener("input",s)}else{document.querySelector(".search-icon").addEventListener("click",s);t.addEventListener("keypress",(e=>{if(e.key==="Enter"){s()}}))}window.addEventListener("search:loaded",s);document.querySelectorAll(".popup-trigger").forEach((s=>{s.addEventListener("click",(()=>{document.body.classList.add("search-active");setTimeout((()=>t.focus()),500);if(!e.isfetched)e.fetchData()}))}));const c=()=>{document.body.classList.remove("search-active")};document.querySelector(".search-pop-overlay").addEventListener("click",(e=>{if(e.target===document.querySelector(".search-pop-overlay")){c()}}));document.querySelector(".popup-btn-close").addEventListener("click",c);document.addEventListener("pjax:success",(()=>{e.highlightSearchWords(document.querySelector(".post-body"));c()}));window.addEventListener("keyup",(e=>{if(e.key==="Escape"){c()}}))}));