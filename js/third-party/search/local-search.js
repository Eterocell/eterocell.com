document.addEventListener("DOMContentLoaded",(()=>{if(CONFIG.path){let t=new LocalSearch({path:CONFIG.path,top_n_per_article:CONFIG.localsearch.top_n_per_article,unescape:CONFIG.localsearch.unescape}),c=document.querySelector(".search-input"),a=document.querySelector(".search-result-container");var e=()=>{if(t.isfetched){var e=c.value.trim().toLowerCase(),r=e.split(/[-\s]+/);let n=[];0<e.length&&(n=t.getResultItems(r)),1===r.length&&""===r[0]?a.innerHTML='<div class="search-result-icon"><i class="fa fa-search fa-5x"></i></div>':0===n.length?a.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>':(n.sort(((e,t)=>e.includedCount!==t.includedCount?t.includedCount-e.includedCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id)),e=CONFIG.i18n.hits.replace("${hits}",n.length),a.innerHTML=`<div class="search-stats">${e}</div>\n        <hr>\n        <ul class="search-result-list">${n.map((e=>e.item)).join("")}</ul>`,"object"==typeof pjax&&pjax.refresh(a))}};t.highlightSearchWords(document.querySelector(".post-body")),CONFIG.localsearch.preload&&t.fetchData(),c.addEventListener("input",e),window.addEventListener("search:loaded",e),document.querySelectorAll(".popup-trigger").forEach((e=>{e.addEventListener("click",(()=>{document.body.classList.add("search-active"),setTimeout((()=>c.focus()),500),t.isfetched||t.fetchData()}))}));let r=()=>{document.body.classList.remove("search-active")};document.querySelector(".search-pop-overlay").addEventListener("click",(e=>{e.target===document.querySelector(".search-pop-overlay")&&r()})),document.querySelector(".popup-btn-close").addEventListener("click",r),document.addEventListener("pjax:success",(()=>{t.highlightSearchWords(document.querySelector(".post-body")),r()})),window.addEventListener("keyup",(e=>{"Escape"===e.key&&r()}))}else console.warn("`hexo-generator-searchdb` plugin is not installed!")}));